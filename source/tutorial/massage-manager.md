---
title: Boardcast And Subscription
date: 2020-05-08
version: 4.0.0
keywords: [Boardcast, Subscription]
---
> **NOTE** This article is **Machine-Translated**. If you have any questions about this article, please send an <a href="mailto:dev@dji.com">E-mail </a>to DJI, we will correct it in time. DJI appreciates your support and attention.     

## Overview
In order to improve the safety of applications when controlling drones perform tasks, OSDK provides data broadcasting and data subscription functions. The application with broadcasting functions could broadcasting the information in real-time.The application with data subscription functions can obtain the data generated by the sensors on the drone and the flight status of the drone in real-time .

## Concepts

### Subscription
According to the actual flight status of the drone, various components and third-party sensors will generate a large amount of data information in real-time and pushed to other modules by the drone. The application with subscription could record the data user need.

#### Topic
Table1 Shows the topic that the data could be subscribed from the drone.

<div>
<div style="text-align: center"><p>
Table1. The Topic On The Drone </p></div>
<div>
<table>
  <thead>
      <th> Item </th>
      <th> Topic </th>
      <th> Frequency (Hz) </th>
  </thead>
  <tbody>
  <tr>
      <th rowspan="4"> Basic Content </th>
      <td> Gesture Guaternion </td>
      <td> 200 </td>
    </tr>
    <tr>
      <td> Hardware Sync </td>
      <td> 400 </td>
    </tr>
    <tr>
      <td> Home Point and Status </td>
      <td> 50 </td>
    </tr>
    <tr>
      <td> Remote Controller </td>
      <td> 50 </td>
    </tr>
    <tr>
      <th rowspan="7"> Drone's Status </th>
      <td> Flight Status </td>
      <td> 50 </td>
    </tr>
    <tr>
      <td> Flight Mode </td>
      <td> 50 </td>
    </tr>
    <tr>
      <td> Landing Gear </td>
      <td> 50 </td>
    </tr>
    <tr>
      <td> ESC </td>
      <td> 50 </td>
    </tr>
    <tr>
      <td> Battery </td>
      <td> 50 </td>
    </tr>
    <tr>
      <td> Error code of the motor </td>
      <td> 50 </td>
    </tr>
    <tr>
      <td> Abnormal Flight </td>
      <td> 50 </td>
    </tr>
    <tr>
    <th rowspan="6"> Drone's Speed </th>
      <td> Flight speed </td>
      <td> 200 </td>
    </tr>
    <tr>
      <td> Fusion Angular Velocity </td>
      <td> 200 </td>
    </tr>
    <tr>
      <td> Original Angular Velocity </td>
      <td> 400 </td>
    </tr>
        <tr>
      <td> Original Acceleration </td>
      <td> 400 </td>
    </tr>
        <tr>
      <td> Acceleration(Geodetic Coordinate) </td>
      <td> 200 </td>
    </tr>
        <tr>
      <td> Acceleration(Body Coordinate)</td>
      <td> 200 </td>
    </tr>
    <tr>
     <th rowspan="8"> Sensor </th>
    <tr>
      <td> Barometer Height </td>
      <td> 200 </td>
    </tr>
        <tr>
      <td> Fusion Barometer Altitude </td>
      <td> 200 </td>
    </tr>
            <tr>
      <td> Barometer Altitude At The Home Point </td>
      <td> 1 </td>
    </tr>
    <tr>
      <td> Relative Height Of Fusion </td>
      <td> 100 </td>
    </tr>
    <tr>
      <td> Compass </td>
      <td> 100 </td>
    </tr>
    <tr>
      <td> VO Visual Position </td>
      <td> 200 </td>
    </tr>
      <tr>
      <td> Obstacle Avoidance </td>
      <td> 100 </td>
    </tr>
    <th rowspan="4"> Gimbal </th>
    <tr>
      <td> Gimbal Atatus </td>
      <td> 50 </td>
    </tr>
        <tr>
      <td> Gimbal's Angle </td>
      <td> 200 </td>
    </tr>
      <tr>
      <td> Gimbal's Mode </td>
      <td> 50 </td>
    </tr>
        <th rowspan="6"> Location </th>
    <tr>
      <td> GPS Signal Level </td>
      <td> 50 </td>
    </tr>
        <tr>
      <td> GPS Original Information </td>
      <td> 5 </td>
    </tr>
      <tr>
      <td> GPS Fusion Information </td>
      <td> 50 </td>
    </tr>
          <tr>
      <td> RTK Connection Status </td>
      <td> 50 </td>
    </tr>
          <tr>
      <td> RTK Original Information </td>
      <td> 5 </td>
    </tr>
  </tbody>
</table> </div> </div>

#### Rules
* The message subscription function supports up to 0Hz, 1Hz, 10Hz, 50Hz, 100Hz, **5 types of frequency**, each subscription can only be subscribed only once.
* When specifying the subscription frequency, the subscription frequency of any parameter cannot be less than or equal to 0, and the total data length of topics with the same subscription frequency must be less than or equal to 242.

### Broadcast
According to the actual flight conditions of the drone, various components and third-party sensors will generate a large amount of data information in real-time. The broadcast function of the OSDK can not only receive the data actively pushed by the drone to other modules, but also receive the data of third-party sensors. The Mobile APP developed based on MSDK, the Onboard Computer developed based on OSDK could receive the broadcast information of the drone and record broadcast information.

#### Broadcast
Applications with OSDK broadcast can broadcast the following information:
* Sensor Information: Sensor such as gyroscope and magnetometer
* Fusion: such as attitude and global position
* Basic Information: battery, gimbal and flight status

#### Frequency
* The broadcast of OSDK supports up to 0Hz, 1Hz, 10Hz, 50Hz, 100Hz, **5 types of frequency**, each broadcast item can only be broadcast once. For example, if you specify 50 Hz for the GPS and 10 Hz for the gyroscope, the entire packet from the broadcast will come in at 50 Hz, but the gyroscope will only appear once every 5 packets.
* After using OSDK's broadcast, applications developed based on OSDK will broadcast data at the default frequency. To change the broadcast frequency, please call the API of the broadcast or use DJI Assistant 2 to change the broadcast frequency.
* When specifying the broadcast's frequency, the frequency of any parameter cannot be less than or equal to 0, and the total data length of topics with the same subscription frequency must be less than or equal to 242.

> **NOTE** Due to the large bandwidth occupied by the broadcast and the OSDK wouldn't develop the broadcast function, so we recommended to use the Subscription function.


## Develop With Subscription
#### 1. Verify 
```c++
    ACK::ErrorCode subscribeStatus;
    subscribeStatus=vehicle->subscribe->verify(timeout);
    if (ACK::getError(subscribeStatus) != ACK::SUCCESS) {
      ACK::getErrorCodeMessage(subscribeStatus, __func__);
      return false;
    }
```

#### 2. Initialization
After initialized the message subscription function, the developer needs to specify the topic, frequency, package number, and data size.

```c+
    bool enableTimestamp=false;
    bool pkgStatus=vehicle->subscribe->initPackageFromTopicList(
        pkgIndex, topicSize, topicList, enableTimestamp, freq);
    if (!(pkgStatus)) {
      return pkgStatus;
    }
```

#### 3. Get Subscription's Data
```c+
    subscribeStatus=vehicle->subscribe->startPackage(pkgIndex, timeout);
    if (ACK::getError(subscribeStatus) != ACK::SUCCESS) {
      ACK::getErrorCodeMessage(subscribeStatus, __func__);
```

#### 4. Clear and Stop    
Clear cache and stop subscription.

```c
      ACK::ErrorCode ack=vehicle->subscribe->removePackage(pkgIndex, timeout);
      if (ACK::getError(ack)) {
        DERROR(
            "Error unsubscription; please restart the drone/FC to get "
            "back to a clean state");
      }
      return false;
    }
    return true;
  } else {
    DERROR("vehicle haven't been initialized", __func__);
    return false;
  }
```

Developers can choose a set of "topic" or "subscription data sets" and add them in the "subscription" package, and configure the corresponding subscription frequency. Users using the DJI Onboard API can configure five data packages, at the same time, a separate frequency can be set for each data package. OSDK provide a buffer(300 bytes), allowing users add more subscriptions to each package.

<div>
<div style ="text-align: center"> <p> Figure 1. Topic Subscription </p>
</div>
<div style ="text-align: center"> <p> <span>
      <img src ="../images/samples/telemetry_output.png"width ="600"style ="vertical-align: middle"alt /> </span> </p>
</div> </div>


